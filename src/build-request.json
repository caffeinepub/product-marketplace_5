{
  "kind": "build_request",
  "title": "Fix product visibility in marketplace after upload",
  "priority": "high",
  "requirements": [
    {
      "id": "REQ-81",
      "text": "Debug and fix the backend getAllProducts function to ensure it returns all uploaded products without filtering or omitting any entries",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-last"
        ],
        "quotes": [
          "make all uploads show in store"
        ]
      },
      "acceptanceCriteria": [
        "Backend getAllProducts() function returns complete list of all products in storage",
        "No products are filtered out or hidden from the response",
        "Function handles empty product lists gracefully"
      ]
    },
    {
      "id": "REQ-82",
      "text": "Verify the useProducts React Query hook in useQueries.ts correctly fetches and caches all products from the backend without client-side filtering",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-last"
        ],
        "quotes": [
          "make all uploads show in store"
        ]
      },
      "acceptanceCriteria": [
        "useProducts hook successfully fetches complete product list",
        "No client-side filtering removes products from the displayed list",
        "Query cache properly invalidates after product creation"
      ]
    },
    {
      "id": "REQ-83",
      "text": "Ensure ProductGrid component renders all products returned from useProducts without applying hidden filters or conditions that would exclude certain products",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-last"
        ],
        "quotes": [
          "make all uploads show in store"
        ]
      },
      "acceptanceCriteria": [
        "ProductGrid displays every product in the products array",
        "No conditional rendering logic hides products unexpectedly",
        "Empty states display correctly when no products exist"
      ]
    },
    {
      "id": "REQ-84",
      "text": "Verify that both SingleProductUploader and BatchUploader components properly invalidate the products cache after successful upload to trigger immediate UI refresh",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-last"
        ],
        "quotes": [
          "make all uploads show in store"
        ]
      },
      "acceptanceCriteria": [
        "Products query cache is invalidated after successful single product upload",
        "Products query cache is invalidated after successful batch upload",
        "Marketplace page automatically refetches and displays new products"
      ]
    },
    {
      "id": "REQ-85",
      "text": "Add comprehensive logging in the product creation and retrieval flow to track when products are created in the backend and when they appear in the frontend queries",
      "target": "both",
      "source": {
        "messageIds": [
          "msg-last"
        ],
        "quotes": [
          "make all uploads show in store"
        ]
      },
      "acceptanceCriteria": [
        "Backend logs product creation with product ID and details",
        "Frontend logs product fetch responses with count and IDs",
        "Cache invalidation events are logged with timestamps"
      ]
    }
  ],
  "constraints": [
    "Respect single-actor architecture in backend/main.mo",
    "Do not modify immutable frontend paths: useInternetIdentity.ts, useActor.ts, main.tsx, components/ui"
  ],
  "nonGoals": [
    "Implementing new product filtering features",
    "Adding product search functionality",
    "Modifying product data structure or schema",
    "Changing the visual design of the marketplace"
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}